/*
 * Copyright (C) 2019 DRLM Project
 * Authors: DRLM Common authors
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

syntax = "proto3";

import "google/protobuf/timestamp.proto";

package drlm;

service DRLM {
    rpc UserLogin(UserLoginRequest) returns (UserLoginResponse) {}
    rpc UserTokenRenew(UserTokenRenewRequest) returns (UserTokenRenewResponse) {}
    rpc UserAdd(UserAddRequest) returns (UserAddResponse) {}
    rpc UserDelete(UserDeleteRequest) returns (UserDeleteResponse) {}
    rpc UserList(UserListRequest) returns (UserListResponse) {}
    // rpc AgentAdd(AgentAddRequest) returns (AgentAddResponse) {}
    // rpc AgentDelete(AgentDeleteRequest) returns (AgentDeleteResponse) {}
    // rpc AgentList(AgentListRequest) returns (AgentListResponse) {}
}

enum AuthType {
    LOCAL = 0;
}

message UserLoginRequest {
    string usr = 2;
    string pwd = 3;
}
message UserLoginResponse {
    string tkn = 1;
    google.protobuf.Timestamp tkn_expiration = 2;
}

message UserTokenRenewRequest {}
message UserTokenRenewResponse {
    string tkn = 1;
    google.protobuf.Timestamp tkn_expiration = 2;
}

message UserAddRequest {
    string usr = 2;
    string pwd = 3;
}
message UserAddResponse {}

message UserDeleteRequest {
    string usr = 2;
}
message UserDeleteResponse {}

message UserListRequest {}
message UserListResponse {
    message User {
        string usr = 1;
        AuthType auth_type = 2;
        google.protobuf.Timestamp created_at = 3;
        google.protobuf.Timestamp updated_at = 4;
    }

    repeated User users = 1;
}
